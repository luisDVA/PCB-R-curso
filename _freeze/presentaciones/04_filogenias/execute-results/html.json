{
  "hash": "e68d27d88a23af92bbd874a7d4866fe7",
  "result": {
    "markdown": "---\ntitle: \"Filogenias\"\nauthor: Axel Arango & Luis D. Verde Arregoitia\nformat:\n  revealjs:\n    theme: curso_styles.scss\n    chalkboard: true\n    transition: fade\n    progress: true\n    multiplex: false\n    preview-links: true\n    hide-inactive-cursor: true\n    highlight-style: pygments\n    pause: true\neditor: source\nknitr:\n  opts_chunk:\n    dev: \"ragg_png\"\n    retina: 3\n    dpi: 200\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n---\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-1_a27cb982fb01af0c21a77ca66bc2bd03'}\n\n:::\n\n\n## Filogenias en R\n\n¿árbol filogenético?\n  \n . . . \n  \nDiagrama que muestra la relación evolutiva/similitud entre especies (o taxones)\n\n##\n\n<br/>\n\nUno de los formatos más utilizados para representar filogenias son el *Newick*(.tree)  \n\n<br/><br/>\n\nEl formato Newick es una notación para representar relaciones evolutivas utilizando paréntesis y comas.\n\nA y B se parecen más entre sí que a X\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/prueba newick_609bfa2fc967aa652b7fd034f96bd9ef'}\n\n```{.r .cell-code}\n\"((A,B),X);\"\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"((A,B),X);\"\n```\n:::\n:::\n\n\n##\n\nPara trabajar con esta notación, podemos usar `ape` (Analysis of Phylogenetics and Evolution):\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/newick_5273d4df8497143849d5f589d0efeab1'}\n\n```{.r .cell-code}\nlibrary(ape)\nread.tree(text=\"((A,B),X);\") %>% \n  plot()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/newick-1.png){width=2000}\n:::\n:::\n\n\n##\n\nEl formato Newick es anidado:\n\nLos lobos, coyotes y zorros pertenecen a Canidae; los lobos y coyotes (género _Canis_) están más estrechamente relacionados\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/canii_26172aa76825dfd04565942bb78d71b6'}\n\n```{.r .cell-code}\nCanidae <-\"(Vulpes_vulpes,(Canis_lupus,Canis_latrans));\"\nread.tree(text=Canidae) %>% \n  plot()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/canii-1.png){width=2000}\n:::\n:::\n\n\n\n##\n\nSi agregamos murciélagos, todos pertenecen a los mamíferos:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-2_3d676e2d480d910b93e96d66570ec675'}\n\n```{.r .cell-code}\nMammalia <-\"(Desmodus_rotundus,(Vulpes_vulpes,(Canis_lupus,Canis_latrans)));\"\nread.tree(text=Mammalia) %>% \n  plot()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-2-1.png){width=2000}\n:::\n:::\n\n\n\n##\n\nSi quisieramos agregar cuervos y zanates. ¿Éstos dónde irían?\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-3_05a40d94dfef97022f3f1decab544a6f'}\n\n```{.r .cell-code}\ntetrapoda<-\"((Quiscalus_mexicanus,Corvus_corax),(Desmodus_rotundus,(Vulpes_vulpes,(Canis_lupus,Canis_latrans))));\"\n\nread.tree(text=tetrapoda) %>% \n  plot()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-3-1.png){width=2000}\n:::\n:::\n\n\n##\n\nAgregando una planta, los mamíferos y las aves se anidan\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/planta_019e114fc32540f7364f972267b73e45'}\n\n```{.r .cell-code}\nEukarya<-\"(Sideroxylon_celastrinum,((Quiscalus_mexicanus,Corvus_corax),(Desmodus_rotundus,(Vulpes_vulpes,(Canis_lupus,Canis_latrans)))));\"\n\nNktree<-read.tree(text=Eukarya)\nplot(Nktree)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/planta-1.png){width=2000}\n:::\n:::\n\n\n## Graficando filogenias con `ggtree`\n\n`ggtree` nos permite graficar, personalizar, anotar árboles filogenéticos usando la gramática de gráficos\n\n## Paquetes necesarios:\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-5_e02d55c6dc9380d150a83c1258887198'}\n\n```{.r .cell-code}\nlibrary(ape)\nlibrary(ggtree)\nlibrary(deeptime)\nlibrary(tidytree)\nlibrary(ggimage)\n```\n:::\n\n\n## Icteridae\n\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-6_8d06937b25a3fa5027ab539a2b86112c'}\n\n```{.r .cell-code}\nictree <-read.tree(here(\"data\",\"Icteridae_tree.txt\"))\nictree\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nPhylogenetic tree with 100 tips and 99 internal nodes.\n\nTip labels:\n  Icterus_melanopsis, Icterus_northropi, Icterus_laudabilis, Icterus_dominicensis, Icterus_cayanensis, Icterus_pyrrhopterus, ...\nNode labels:\n  761, 762, 763, 764, 765, 766, ...\n\nRooted; includes branch lengths.\n```\n:::\n:::\n\n\n## \n\nVisualizando el objeto con `ape`\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-7_937b6a4e26b39a10e6ec6716314cb87a'}\n\n```{.r .cell-code}\nplot(ictree, show.tip.label=F)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-7-1.png){width=2000}\n:::\n:::\n\n\n## \n\nCon `ggtree`\n\n> Asignamos la figura al objeto `p1`\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-8_eef2133ee9f9c52479f28c5724e7e041'}\n\n```{.r .cell-code}\np1<-ggtree(ictree,color=\"black\",size=0.5)\np1\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-8-1.png){width=2000}\n:::\n:::\n\n\n## \n\nEl argumento/función `layout` cambia la disposición del árbol:\n\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-9_7392ee20513458fd596336593d1a6843'}\n\n```{.r .cell-code}\np1+layout_dendrogram()+\n  p1+layout_fan()+\n  p1+layout_circular()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-9-1.png){width=2000}\n:::\n:::\n\n\n## \nCambiar el color del fondo:\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-10_6f0f9a1f32c1ca712a250c846910bbf2'}\n\n```{.r .cell-code}\np1+\n  theme_tree(bgcolor=\"lightblue\")\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-10-1.png){width=2000}\n:::\n:::\n\n\n## \n\nAgregar las etiquetas de las puntas:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-11_a47c5556d97448a20a258811b684b61a'}\n\n```{.r .cell-code}\np1+\n  geom_tiplab(size=1,color=\"darkblue\",angle=10)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-11-1.png){width=2000}\n:::\n:::\n\n\n## \n\nFormas en cada punta\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-12_0174399ea47641bad1f5f948d8dcdf4a'}\n\n```{.r .cell-code}\np1+\n  geom_tippoint(size=1,color=\"brown\",shape=10)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-12-1.png){width=2000}\n:::\n:::\n\n\n## \n\nRotular nodos:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-13_299a17d9d947f13226849bb186db88c3'}\n\n```{.r .cell-code}\np1+ \n  geom_nodelab(size=1,color=\"purple\")\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-13-1.png){width=2000}\n:::\n:::\n\n\n## \n\nPuntos en cada nodo:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-14_11c2113b0609d3b96ae7be4fe43528db'}\n\n```{.r .cell-code}\np1+ \n  geom_nodepoint(size=2,color=\"red\",shape=16)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-14-1.png){width=2000}\n:::\n:::\n\n\n## \nA gregar una escala temporal a la filogenia, con el paquete `deeptime`\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-15_2619b5bc02c1f7a4af313ee40bfe29b2'}\n\n```{.r .cell-code}\npy<-revts(p1)\npy+coord_geo(xlim=c(-10,-1),abbrv = F,neg=T,skip=NULL,dat=\"stage\",size=1.5)+\n  theme_tree2()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-15-1.png){width=2000}\n:::\n:::\n\n\n## \n\nCombinando `geoms`\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-16_4a5c187a8437efdf4b772f8f59960287'}\n\n```{.r .cell-code}\np1+ \n  layout_dendrogram()+\n  theme_tree(bgcolor=\"#e9f0ea\")+\n  geom_tiplab(size=0.5,color=\"darkblue\",angle=45)+\n  geom_tippoint(size=1,color=\"brown\",shape=10)+\n  geom_nodelab(size=1,color=\"purple\")+\n  geom_nodepoint(size=2,color=\"red\",alpha=0.3,shape=16)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-16-1.png){width=2000}\n:::\n:::\n\n\n## Anotaciones \n\n> ej: destacar el género *Quiscalus*\n\n\n- encontrar el nodo del ancestro en común más reciente\n- crear un *tibble* con la información del árbol\n- buscar las especies de *Quiscalus*:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-17_d6a13e96bd817700d6a2060f38217abe'}\n\n```{.r .cell-code}\nictree %>%\n  as_tibble %>%\n  filter(grepl(\"Quiscalus\",label))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  parent  node branch.length label                  \n   <int> <int>         <dbl> <chr>                  \n1    146    41         1.82  Quiscalus_quiscula     \n2    148    42         0.851 Quiscalus_niger        \n3    149    43         0.335 Quiscalus_major        \n4    149    44         0.335 Quiscalus_mexicanus    \n5    150    45         1.02  Quiscalus_nicaraguensis\n6    150    46         1.02  Quiscalus_lugubris     \n```\n:::\n:::\n\n\n## \n\nAncestro común más reciente (`MRCA()`) de las dos especies en el género con la longitud de rama más larga y más corta\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-18_86c8b9b227027f7b584ad86340eef6a8'}\n\n```{.r .cell-code}\nictree %>%\n  as_tibble %>%\n  MRCA(41,43)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n  parent  node branch.length label\n   <int> <int>         <dbl> <chr>\n1    144   146          1.37 806  \n```\n:::\n:::\n\n\n. . .\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-19_8915eb2f1760e2c6a0423b14ef68cc9d'}\n\n```{.r .cell-code}\nictree %>%\n  as_tibble %>%\n  MRCA(\"Quiscalus_quiscula\",\"Quiscalus_mexicanus\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n  parent  node branch.length label\n   <int> <int>         <dbl> <chr>\n1    144   146          1.37 806  \n```\n:::\n:::\n\n\n## \n\nAnotar el género *Quiscalus* en la filogenia utilizando `geom_cladelab` (nodo 146)\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-20_ef4db4b68b44fab3ca6ed913bad9070b'}\n\n```{.r .cell-code}\np1+\n  geom_cladelab(node=146,label = \"Quiscalus\",offset=0,\n                barcolor=\"red\",textcolor=\"brown\",\n                angle=-90, offset.text=0.1,hjust=0.5)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-20-1.png){width=2000}\n:::\n:::\n\n\n## \n\nDestacar el género*Icterus*:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-21_dfd83be7d34d0249847ca11262182791'}\n\n```{.r .cell-code}\nictree %>%\n  as_tibble %>%\n  filter(grepl(\"Icterus\",label))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 31 × 4\n   parent  node branch.length label                \n    <int> <int>         <dbl> <chr>                \n 1    111     1         0.193 Icterus_melanopsis   \n 2    111     2         0.193 Icterus_northropi    \n 3    114     3         1.47  Icterus_laudabilis   \n 4    114     4         1.47  Icterus_dominicensis \n 5    116     5         0.197 Icterus_cayanensis   \n 6    116     6         0.197 Icterus_pyrrhopterus \n 7    115     7         0.943 Icterus_auricapillus \n 8    117     8         1.49  Icterus_bonana       \n 9    117     9         1.49  Icterus_portoricensis\n10    118    10         2.24  Icterus_prosthemelas \n# ℹ 21 more rows\n```\n:::\n:::\n\n\n##\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-22_c6da6caf5ab9fecf15b8204eccef809e'}\n\n```{.r .cell-code}\nictree %>%\n  as_tibble %>%\n  MRCA(25,14)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n  parent  node branch.length label\n   <int> <int>         <dbl> <chr>\n1    103   104          2.92 764  \n```\n:::\n:::\n\n\n## \n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-23_eb05081941ecfbbe9d66785e6af0a00b'}\n\n```{.r .cell-code}\np1+xlim(0,11)+\n  geom_cladelab(node=104,label=\"Icterus\",geom=\"label\",\n                fill=\"yellow\",textcolor=\"red\", barcolor=\"gray\",angle=90,size=19)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-23-1.png){width=2000}\n:::\n:::\n\n\n## \n\n`geom_strip()` para dibujar líneas entre dos puntas arbitrarias\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-24_ac2b71e11d9f48f72944ba9eef469d3c'}\n\n```{.r .cell-code}\np1+xlim(0,15)+\n  geom_strip(\"Quiscalus_quiscula\",\"Icterus_icterus\",\n             label=\" un clado polifilético\", barsize = 2, offset.text = 0.2,size=15)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-24-1.png){width=2000}\n:::\n:::\n\n\n## \n\n`geom_highlight` para destacar clados sobre las mismas ramas:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-25_bad764a19f63532f39b2711a93850e8e'}\n\n```{.r .cell-code}\np1+\n  geom_highlight(node=146,alpha=0.5,fill=\"purple\",type = \"rect\")\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-25-1.png){width=2000}\n:::\n:::\n\n\n## \n\nhighlight + rótulo\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-26_4f3e615596eb5e5cb25f487778847bca'}\n\n```{.r .cell-code}\np1+\n  geom_highlight(node=146,alpha=0.5,fill=\"purple\",type = \"rect\")+\n  geom_cladelab(node=146,label = \"Quiscalus\",offset=0,barcolor=\"#9418f2\",textcolor=\"#4c0980\", offset.text=0)+\n  xlim(0,11.5)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-26-1.png){width=2000}\n:::\n:::\n\n\n## \n\n### Enriquecer figuras con imágenes \n\n- siluetas desde [phylopic](https://www.phylopic.org/) o imagenes propias. \n\n- Es necesario cargar `rsvg` primero\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-27_4df53f24b8f8d394fac1a4d0ac604929'}\n\n```{.r .cell-code}\nlibrary(\"rsvg\")\n```\n:::\n\n\n\n### Requisitos\n\n- tabla con nodos, especies o clados a anotar, y el identificador de los mismos en Phylopic (_phylopic_id_)\n\n## \n\n*Quiscalus* y *Agelaius* tienen imagenes indexadas en *phylopic*\n\nEncontrar los identificadores con  `phylopic_uid()`\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-28_0086b8b8db1bbe7a171310b88296a668'}\n\n```{.r .cell-code}\nids<-phylopic_uid(c(\"Quiscalus\",\"Agelaius\"))\nids\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               name                                  uid\nQuiscalus Quiscalus 2ada4e2f-35ab-48d2-b32e-3bad57033dd4\nAgelaius   Agelaius 2a48d7c6-5e9d-4d71-9291-ff4c68643cdf\n```\n:::\n:::\n\n\n## \n\nTabla con los datos necesarios para anotar nuestra filogenia:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-29_b2e475ba7fb08128312077fd774ec9dc'}\n\n```{.r .cell-code}\ndt<-data.frame(node=c(146,136),image=ids$uid,genus=c(\"Quiscalus\",\"Agelaius\"))\ndt\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  node                                image     genus\n1  146 2ada4e2f-35ab-48d2-b32e-3bad57033dd4 Quiscalus\n2  136 2a48d7c6-5e9d-4d71-9291-ff4c68643cdf  Agelaius\n```\n:::\n:::\n\n\n## \n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-30_6d0153603790d328ee38bbc76604e71c'}\n\n```{.r .cell-code}\np1+ geom_cladelab(data = dt, \n                  mapping = aes(node = node, label = genus, \n                                image = image, color = genus), \n                  geom = \"phylopic\", offset = 0, offset.text=0.5)\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-30-1.png){width=2000}\n:::\n:::\n\n\n## \n\nCambiando los colores de las figuras siguiendo gramática de gráficos:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-31_3dba9ed9a9b397d0b0a0741bc73b2a9b'}\n\n```{.r .cell-code}\np1+ geom_cladelab(data = dt, \n                  mapping = aes(node = node, label = genus, \n                                image = image, color = genus), \n                  geom = \"phylopic\", offset = 0, offset.text=0.5)+ scale_color_manual(values=c(\"#f75419\",\"purple\"))\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-31-1.png){width=2000}\n:::\n:::\n\n\n## \n\nMás `geoms`\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-32_f478cd0a6ad03d6d941932bcf65ae693'}\n\n```{.r .cell-code}\npr<-p1+ geom_cladelab(data = dt, \n                      mapping = aes(node = node, label = genus, \n                                    image = image, color = genus), \n                      geom = \"phylopic\", offset = 0, offset.text=0.5)+\n  scale_color_manual(values=c(\"#f75419\",\"purple\"))+\n  geom_highlight(node=146,alpha=0.5,fill=\"purple\",type = \"rect\")+\n  geom_highlight(node=136,alpha=0.5,fill=\"#f75419\",type = \"rect\")\npr\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-32-1.png){width=2000}\n:::\n:::\n\n\n## \n\nEjemplo con múltiples anotaciones por Axel Arango:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-33_414ab8bd5f9b5c5a5c7a22546b3b01d3'}\n\n:::\n\n\n## \n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-34_8b5dd67366ba2091dc5f9e5bf62e1d80'}\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-34-1.png){width=2000}\n:::\n:::\n\n\n\n## Graficando atributos de las especies en la filogenia.\n\nCargar los atributos, en este caso Hand Wing Index (HWI) y el hábito migratorio:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-35_a2ac3aee6d67797b045c82a1324d6322'}\n\n```{.r .cell-code}\nhwi<-read.csv(here(\"data\",\"hwi_icteridae.csv\"),header=T)\nhead(hwi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                     X      HWI\n1   Icterus_melanopsis 26.51912\n2    Icterus_northropi 21.02135\n3   Icterus_laudabilis 22.22500\n4 Icterus_dominicensis 26.52877\n5   Icterus_cayanensis 26.26213\n6 Icterus_pyrrhopterus 17.75463\n```\n:::\n:::\n\n\n## \n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-36_cdedeb3b1098fb1a825f71b02e3f18b8'}\n\n```{.r .cell-code}\nmigrants<-read.csv(here(\"data\",\"icterimigrants.csv\"),header=T)\nhead(migrants)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   sp  migratory\n1  Agelaioides_badius No-migrant\n2  Agelaius_assimilis No-migrant\n3  Agelaius_humeralis No-migrant\n4 Agelaius_phoeniceus    Migrant\n5   Agelaius_tricolor No-migrant\n6  Agelaius_xanthomus No-migrant\n```\n:::\n:::\n\n\n## \n\nUnienr con la filogenia (es importante que las especies estén rotuladas como label)\n\n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-37_1ba225e3f2f5793e64a758b48b0c5da2'}\n\n```{.r .cell-code}\nnames(hwi)<-c(\"label\",\"hwi\")\nnames(migrants)<-c(\"label\",\"migratory\")\n\nhwimigrants<-hwi%>%\n  left_join(migrants,by=\"label\")\ndatatree<-full_join(ictree,hwimigrants,by=\"label\")\ndatatree\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'treedata' S4 object'.\n\n...@ phylo:\n\nPhylogenetic tree with 100 tips and 99 internal nodes.\n\nTip labels:\n  Icterus_melanopsis, Icterus_northropi, Icterus_laudabilis,\nIcterus_dominicensis, Icterus_cayanensis, Icterus_pyrrhopterus, ...\nNode labels:\n  761, 762, 763, 764, 765, 766, ...\n\nRooted; includes branch lengths.\n\nwith the following features available:\n  '', 'hwi', 'migratory'.\n\n# The associated data tibble abstraction: 199 × 5\n# The 'node', 'label' and 'isTip' are from the phylo tree.\n    node label                 isTip   hwi migratory \n   <int> <chr>                 <lgl> <dbl> <chr>     \n 1     1 Icterus_melanopsis    TRUE   26.5 No-migrant\n 2     2 Icterus_northropi     TRUE   21.0 No-migrant\n 3     3 Icterus_laudabilis    TRUE   22.2 No-migrant\n 4     4 Icterus_dominicensis  TRUE   26.5 No-migrant\n 5     5 Icterus_cayanensis    TRUE   26.3 No-migrant\n 6     6 Icterus_pyrrhopterus  TRUE   17.8 No-migrant\n 7     7 Icterus_auricapillus  TRUE   17.3 No-migrant\n 8     8 Icterus_bonana        TRUE   16.9 No-migrant\n 9     9 Icterus_portoricensis TRUE   22.3 No-migrant\n10    10 Icterus_prosthemelas  TRUE   24.1 No-migrant\n# ℹ 189 more rows\n```\n:::\n:::\n\n\n## Filogenia con atributos\n\n- Valores continuos del HWI sobre las puntas del árbol en una escala de colores:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-38_c38411efe502d23deeefbdfa453438d6'}\n\n```{.r .cell-code}\np5<-ggtree(datatree)\np5+\n  geom_tippoint(aes(color=hwi))\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-38-1.png){width=2000}\n:::\n:::\n\n\n## \n\npodemos también personalizar esta escala:\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-39_c0a23a9fea0760a4b0c2b348a49c323d'}\n\n```{.r .cell-code}\np5+\n  geom_tippoint(aes(color=hwi),shape=15)+\n  scale_colour_gradient(low='blue', high='red',breaks= c(15,20,25,30,35))\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-39-1.png){width=2000}\n:::\n:::\n\n\n## Datos binarios\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-40_6e26034f910b35383c1a555ac5935f40'}\n\n```{.r .cell-code}\np5+\n  geom_tippoint(aes(color=migratory),shape=15)+\n  scale_colour_manual(values = c(\"green\",\"orange\"))\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-40-1.png){width=2000}\n:::\n:::\n\n\n## Combinando atributos\n\n  \n\n::: {.cell hash='04_filogenias_cache/revealjs/unnamed-chunk-41_6e35749bb8251773807ebc151f51d1a8'}\n\n```{.r .cell-code}\npx<- py%<+% migrants + geom_tippoint(aes(color=migratory),shape=15)+\n  scale_color_manual(values = c(\"#961d29\",\"#1420a3\"))+\n  scale_fill_manual(values = c(\"#961d29\",\"#1420a3\"))\n\npx+ geom_facet(panel=\"HWI\",data = hwi,geom=geom_col,mapping=aes(x=hwi,color=migratory,fill=migratory),orientation='y')+\n  theme_tree2()\n```\n\n::: {.cell-output-display}\n![](04_filogenias_files/figure-revealjs/unnamed-chunk-41-1.png){width=2000}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}